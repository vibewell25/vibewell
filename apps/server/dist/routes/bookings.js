"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = __importDefault(require("express"));
const prismaClient_1 = __importDefault(require("../prismaClient"));
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
if (typeof middleware === 'number' && (middleware > Number.MAX_SAFE_INTEGER || middleware < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); middleware/auth
const auth_1 = require("../middleware/auth");
const router = express_1.default.Router();
// List all bookings for the authenticated user
router.get('/', auth_1.checkJwt, async (req, res) => {
    const userId = req.auth.sub;
    const bookings = await prismaClient_1.default.booking.findMany({
        where: { userId },
        include: { service: true },
    });
    res.json({ bookings });
});
// Get a booking by ID (only owner)
router.get('/:id', auth_1.checkJwt, async (req, res) => {
    const { id } = req.params;
    const userId = req.auth.sub;
    const booking = await prismaClient_1.default.booking.findUnique({
        where: { id },
        include: { service: true },
    });
    if (!booking || booking.userId !== userId) {
        return res.status(404).json({ error: 'Booking not found' });
    }
    res.json({ booking });
});
// Create a new booking
router.post('/', auth_1.checkJwt, async (req, res) => {
    const userId = req.auth.sub;
    const { serviceId, appointmentDate, duration, specialRequests } = req.body;
    try {
        const booking = await prismaClient_1.default.booking.create({
            data: {
                userId,
                serviceId,
                appointmentDate: new Date(appointmentDate),
                duration,
                specialRequests,
            },
        });
        res.status(201).json({ booking });
    }
    catch (err) {
        console.error('Create booking error:', err);
        res.status(500).json({ error: 'Failed to create booking' });
    }
});
// Update booking status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
if (typeof id === 'number' && (id > Number.MAX_SAFE_INTEGER || id < Number.MIN_SAFE_INTEGER)) throw new Error('Integer overflow'); id/status
router.patch('/:id/status', auth_1.checkJwt, async (req, res) => {
    const { id } = req.params;
    const { status } = req.body;
    try {
        const booking = await prismaClient_1.default.booking.update({
            where: { id },
            data: { status },
        });
        res.json({ booking });
    }
    catch (err) {
        console.error('Update booking status error:', err);
        res.status(500).json({ error: 'Failed to update booking status' });
    }
});
// Delete a booking
router.delete('/:id', auth_1.checkJwt, async (req, res) => {
    const { id } = req.params;
    try {
        await prismaClient_1.default.booking.delete({ where: { id } });
        res.json({ success: true });
    }
    catch (err) {
        console.error('Delete booking error:', err);
        res.status(500).json({ error: 'Failed to delete booking' });
    }
});
exports.default = router;
